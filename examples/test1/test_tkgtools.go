package main

import "github.com/hyrut/go-tkgtools"
import "fmt"

func _visitBytes(b []byte){
  for _, v := range b{
    fmt.Printf("0x%02x,",v)
  }
  fmt.Println()
}

func main(){
  tkg := tkgtools.NewTKGTOOLS()

  key := [16]byte{0x46,0x5b,0x5c,0xe8,0xb1,0x99,0xb4,0x9f,0xaa,0x5f,0x0a,0x2e,0xe2,0x38,0xa6,0xbc}
  op := [16]byte{0xcd,0xc2,0x02,0xd5,0x12,0x3e,0x20,0xf6,0x2b,0x6d,0x67,0x6a,0xc7,0x2c,0xb3,0x18}
  opc := [16]byte{0xcd,0x63,0xcb,0x71,0x95,0x4a,0x9f,0x4e,0x48,0xa5,0x99,0x4e,0x37,0xa0,0x2b,0xaf}
  sqn := [6]byte{0xff,0x9b,0xb4,0xd0,0xb6,0x07}
  rand := [16]byte{0x23,0x55,0x3c,0xbe,0x96,0x37,0xa8,0x9d,0x21,0x8a,0xe6,0x4d,0xae,0x47,0xbf,0x35}
  amf := [2]byte{0xb9,0xb9}

  /*
  key := [16]byte{0xfe,0xc8,0x6b,0xa6,0xeb,0x70,0x7e,0xd0,0x89,0x05,0x75,0x7b,0x1b,0xb4,0x4b,0x8f}
  op := [16]byte{0xdb,0xc5,0x9a,0xdc,0xb6,0xf9,0xa0,0xef,0x73,0x54,0x77,0xb7,0xfa,0xdf,0x83,0x74}
  opc := [16]byte{0x10,0x06,0x02,0x0f,0x0a,0x47,0x8b,0xf6,0xb6,0x99,0xf1,0x5c,0x06,0x2e,0x42,0xb3}
  sqn := [6]byte{0x9d,0x02,0x77,0x59,0x5f,0xfc}
  rand := [16]byte{0x9f,0x7c,0x8d,0x02,0x1a,0xcc,0xf4,0xdb,0x21,0x3c,0xcf,0xf0,0xc7,0xf7,0x1a,0x6a}
  amf := [2]byte{0x72,0x5c}
  */

  var mac_a [8]byte
  var mac_s [8]byte
  var res [8]byte
  var ck [16]byte
  var ik [16]byte
  var ak [6]byte
  var ak_f5s [6]byte

  tkg.F1(&key, &rand, &sqn, &amf, &mac_a, nil, &opc)
  fmt.Print("mac_a(f1): ");_visitBytes(mac_a[:])
  tkg.F2345(&key, &rand, &res, &ck, &ik, &ak, &op, nil)
  fmt.Print("res(f2): ");_visitBytes(res[:])
  fmt.Print("ck(f3): ");_visitBytes(ck[:])
  fmt.Print("ik(f4): ");_visitBytes(ik[:])
  fmt.Print("ak(f5): ");_visitBytes(ak[:])
  tkg.F1star(&key, &rand, &sqn, &amf, &mac_s, &op, nil)
  fmt.Print("mac_s(f1*): ");_visitBytes(mac_s[:])
  tkg.F5star(&key, &rand, &ak_f5s, &op, nil)
  fmt.Print("ak(f5*): ");_visitBytes(ak_f5s[:])
}
/*
Test set 2 in 3GPP TS35.208
Variable	Value
K	465b5ce8 b199b49f aa5f0a2e e238a6bc
RAND	23553cbe 9637a89d 218ae64d ae47bf35
SQN	ff9bb4d0 b607
AMF	b9b9
OP	cdc202d5 123e20f6 2b6d676a c72cb318
OPC	cd63cb71 954a9f4e 48a5994e 37a02baf
f1	4a9ffac3 54dfafb3
f1*	01cfaf9e c4e871e9
f2	a54211d5 e3ba50bf
f5	aa689c64 8370
f3	b40ba9a3 c58b2a05 bbf0d987 b21bf8cb
f4	f769bcd7 51044604 12767271 1c6d3441
f5*	451e8bec a43b
*/
/*
Test set 3 in 3GPP TS35.208
Variable	Value
K	fec86ba6 eb707ed0 8905757b 1bb44b8f
RAND	9f7c8d02 1accf4db 213ccff0 c7f71a6a
SQN	9d027759 5ffc
AMF	725c
OP	dbc59adc b6f9a0ef 735477b7 fadf8374
OPC	1006020f 0a478bf6 b699f15c 062e42b3
f1	9cabc3e9 9baf7281
f1*	95814ba2 b3044324
f2	8011c48c 0c214ed2
f5	33484dc2 136b
f3	5dbdbb29 54e8f3cd e665b046 179a5098
f4	59a92d3b 476a0443 487055cf 88b2307b
f5*	deacdd84 8cc6
*/
