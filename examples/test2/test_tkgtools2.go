package main

import "github.com/hyrut/go-tkgtools"
import "fmt"

func _visitBytes(b []byte){
  for _, v := range b{
    fmt.Printf("0x%02x,",v)
  }
  fmt.Println()
}

func main(){
  tkg := tkgtools.NewTKGTOOLS()
  key := [16]byte{0x12,0x34,0x56,0x78,0x90,0xAB,0xCD,0xEF,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11}
  op := [16]byte{0x12,0x34,0x56,0x78,0x90,0x12,0x34,0x56,0x12,0x34,0x56,0x78,0x90,0x12,0x34,0x56}
  sqnxorak := [6]byte{0x71,0x98,0x73,0xb5,0x50,0xbc}
  rand := [16]byte{0xf4,0x5d,0xb8,0xe7,0x93,0xda,0x5e,0x6c,0x3d,0x03,0x9d,0x7d,0xbe,0x71,0x01,0x31}
  amf := [2]byte{0x80,0x00}

  var sqn [6]byte
  var mac_a [8]byte
  var mac_s [8]byte
  var res [8]byte
  var ck [16]byte
  var ik [16]byte
  var ak [6]byte
  var ak_f5s [6]byte

  tkg.R1 = 32
  tkg.R2 = 19
  tkg.R3 = 47
  tkg.R4 = 73
  tkg.R5 = 91
  tkg.F2345(&key, &rand, &res, &ck, &ik, &ak, &op, nil)
  fmt.Print("res(f2): ");_visitBytes(res[:])
  fmt.Print("ck(f3): ");_visitBytes(ck[:])
  fmt.Print("ik(f4): ");_visitBytes(ik[:])
  fmt.Print("ak(f5): ");_visitBytes(ak[:])

  for i:=0; i<6; i++{
    sqn[i] = sqnxorak[i] ^ ak[i]
  }
  fmt.Print("sqn: ");_visitBytes(sqn[:])

  tkg.F1(&key, &rand, &sqn, &amf, &mac_a, &op, nil)
  fmt.Print("mac_a(f1): ");_visitBytes(mac_a[:])
  tkg.F1star(&key, &rand, &sqn, &amf, &mac_s, &op, nil)
  fmt.Print("mac_s(f1*): ");_visitBytes(mac_s[:])
  tkg.F5star(&key, &rand, &ak_f5s, &op, nil)
  fmt.Print("ak(f5*): ");_visitBytes(ak_f5s[:])
}

/*

  This is an example for CMCC lab card.
  r1 = 32, r2 = 19, r3 = 47, r4 = 73, r5 = 91
  c1 - c5 are default value.

  key := [16]byte{0x12,0x34,0x56,0x78,0x90,0xAB,0xCD,0xEF,0x11,0x11,0x11,0x11,0x11,0x11,0x11,0x11}
  op := [16]byte{0x12,0x34,0x56,0x78,0x90,0x12,0x34,0x56,0x12,0x34,0x56,0x78,0x90,0x12,0x34,0x56}
  sqnxorak := [6]byte{0x71,0x98,0x73,0xb5,0x50,0xbc}
  rand := [16]byte{0xf4,0x5d,0xb8,0xe7,0x93,0xda,0x5e,0x6c,0x3d,0x03,0x9d,0x7d,0xbe,0x71,0x01,0x31}
  amf := [2]byte{0x80,0x00}

  res(f2): 0x77,0x3f,0x31,0x03,0xb9,0xf1,0xb8,0x9a,
  ck(f3): 0x5c,0xa5,0xd0,0x84,0x60,0x03,0xfb,0xdd,0xd6,0x07,0x58,0xf9,0x52,0xa2,0x87,0x1b,
  ik(f4): 0x20,0x0f,0xc6,0x04,0x95,0xef,0xfa,0x85,0xa0,0x39,0x28,0x35,0xd6,0xb7,0x89,0xee,
  ak(f5): 0x71,0x98,0x73,0xb5,0x50,0xba,
  sqn: 0x00,0x00,0x00,0x00,0x00,0x06,
  mac_a(f1): 0xae,0x3d,0x19,0xc2,0xa5,0xe9,0x76,0x39,
  mac_s(f1*): 0x52,0x88,0x6b,0xd6,0x4b,0xb4,0x73,0x19,
  ak(f5*): 0x91,0x7f,0x15,0x1b,0xd3,0xa3,

*/
